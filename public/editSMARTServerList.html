<div class="modal-header">

    <div class="row">
        <div class="col-md-6 col-sm-6">
            <h3 class="modal-title">Edit SMART server list</h3>
        </div>

        <div class="col-md-6 col-sm-6">
            <div class="pull-right">
                <button ng-show="dirty" class="btn btn-primary pull-right" ng-click="save()">Update list</button>
                <button class="btn btn-link pull-right" ng-click="$dismiss()">Cancel</button>
            </div>
        </div>
    </div>
</div>

<div class="modal-body">
    <div class="row">
        <div class = 'col-sm-3'>
            <div class="row">
                <div class="col-sm-8">
                    <strong>Current Servers</strong>
                </div>
                <div class="col-sm-3">
                    <div class="btn btn-link" ng-click="add()">Add</div>
                </div>

            </div>


            <div class="list-group">
                <div ng-class="{'list-group-item':true, active:svr.name == selectedServer.name}"
                     style="cursor: pointer"
                     ng-click="selectSvr(svr)" ng-repeat="svr in servers">
                    {{svr.name}}
                </div>
            </div>
        </div>
        <div class = 'col-sm-9'>


<!-- <small id="emailHelp" class="form-text text-muted">We'll never share your email with anyone else.</small> -->

            <button ng-show="selectedServer" ng-click="remove()" class="pull-right clickable btn btn-link">Delete</button>

            <uib-tabset>



                <uib-tab heading="SMART configuration">
                    <form ng-show="selectedServer">
                        <div class="form-group">
                            <label>Name</label>

                            <input type="text" class="form-control" ng-model="selectedServer.name" placeholder="Enter name" ng-change="change()"/>
                            <small class="form-text text-muted pull-right">A unique name to identify this set</small>
                        </div>

                        <div class="form-group">
                            <label>Description</label>
                            <input type="text" class="form-control" ng-model="selectedServer.description" placeholder="Enter name" ng-change="change()"/>
                            <small class="form-text text-muted pull-right">A more detailed description</small>
                        </div>

                        <div class="form-check">
                            <label>BaseUrl</label>
                            <input type="text" class="form-control" ng-model="selectedServer.baseUrl" ng-change="change()"/>
                            <small class="form-text text-muted pull-right">The url to the FHIR server root. Include the trailing /</small>
                        </div>
                        <br/>
                        <div class="form-check">
                            <label>Callback</label>
                            <input type="text" class="form-control" ng-model="selectedServer.callback" ng-change="change()"/>
                            <small class="form-text text-muted pull-right">The callback URL after Authorization. Should always be {{callBackUrl}} (or the authentication process will fail)</small>
                        </div>
                        <br/>
                        <div class="form-check">
                            <label>clientId</label>
                            <input type="text" class="form-control" ng-model="selectedServer.clientId" ng-change="change()"/>
                            <small class="form-text text-muted pull-right">The unique id assigned to this app by the auth server</small>
                        </div>
                        <br/>
                        <div class="form-check">
                            <label>Secret</label>
                            <input type="text" class="form-control" ng-model="selectedServer.secret" ng-change="change()"/>
                            <small class="form-text text-muted pull-right">The unique secret assigned to this app by the auth server</small>
                        </div>
                        <br/>

                        <div class="form-check">
                            <label>Default scope</label>
                            <input type="text" class="form-control" ng-model="selectedServer.defaultScope" ng-change="change()"/>
                            <small class="form-text text-muted pull-right">The default scope to use</small>
                        </div>

                        <br/>

                        <div class="form-check">
                            <label>Where to open browser</label>
                            <div>
                                <div class="btn-group" >
                                    <label class="btn btn-default" ng-model="selectedServer.browser"
                                           ng-click="change()" uib-btn-radio="'iframe'">iFrame</label>
                                    <label class="btn btn-default" ng-model="selectedServer.browser"
                                           ng-click="change()" uib-btn-radio="'tab'">Separate tab</label>

                                </div>
                                <div>
                                    <small class="form-text text-muted pull-right">Use a separate tab for servers that won't allow the login screen to be in an iFrame</small>

                                </div>

                            </div>
                        </div>



                    </form>
                </uib-tab>

                <uib-tab heading="User details & notes">
                    <form ng-show="selectedServer">
                        <div class="form-group">
                            <label>User name</label>

                            <input type="text" class="form-control" ng-model="selectedServer.userName" placeholder="Enter user name" ng-change="change()"/>
                            <small class="form-text text-muted pull-right">The username you need to log into the server</small>
                        </div>

                        <div class="form-group">
                            <label>Password</label>
                            <input type="text" class="form-control" ng-model="selectedServer.password" placeholder="Enter password" ng-change="change()"/>
                            <small class="form-text text-muted pull-right">Your password</small>
                        </div>

                        <div class="form-group">
                            <label>Notes</label>
                            <textarea class="form-control" ng-model="selectedServer.notes" placeholder="Any notes" ng-change="change()"></textarea>

                            <small class="form-text text-muted pull-right">Any notes about this server</small>
                        </div>
                    </form>

                    <p>
                        <em>
                            Generally, you wouldn't save login details in a config file. This is provided as a convenient place to store them only -
                            the details aren't sent to the server and you'll need to enter them in the login screen in the usual way. The
                            details are stored in your browser cache - but don't use this for real data!
                            <br/><br/>
                            You may want to consider putting a 'hint' in the password field rather than the actual password
                        </em>
                    </p>
                </uib-tab>

                <uib-tab heading="Advanced">
                    <form ng-show="selectedServer">
                        <div class="form-group">
                            <label>Authorization endpoint</label>

                            <input type="text" class="form-control" ng-model="selectedServer.authEP" placeholder="Enter user name" ng-change="change()"/>
                            <small class="form-text text-muted pull-right">The username you need to log into the server</small>
                        </div>

                        <div class="form-group">
                            <label>Token endpoint</label>
                            <input type="text" class="form-control" ng-model="selectedServer.tokenEP" placeholder="Enter password" ng-change="change()"/>
                            <small class="form-text text-muted pull-right">Your password</small>
                        </div>

                        <div class="form-group">
                            <label>Options when calling Auth server</label>

                            <div class="row">
                                <div class="col-sm-2 col-md-2">
                                    <input type="checkbox" class="form-control" ng-model="selectedServer.suppressAud" ng-change="change()"/>
                                </div>
                                <div class="col-sm-8 col-md-8">
                                    <div style="padding: 7px"> Suppress aud parameter</div>
                                </div>
                            </div>
                            <small class="form-text text-muted pull-right">Don't include the 'aud' parameter when authenticating</small>
                        </div>
                    </form>
                    <hr/>

                    <p>
                        <em>
                            <div>You don't generally populate these fields - they are only if the server you're accessing doesn't
                                return the endpoints as SMART extensions in the CapabilityStatement. This means that the server
                                is not SMART compliant, but useful for accessing servers that support OAuth2</div>
                            <div>If they are populated, then the client will not attempt to load the CapabilityStatement,
                                so be sure that that's what you want to happen.</div>
                        </em>
                    </p>

                </uib-tab>


                <uib-tab heading="Json">
                    <pre ng-show="selectedServer">{{selectedServer | json}}</pre>
                </uib-tab>


            </uib-tabset>

        </div>
    </div>

</div>

<div class="modal-footer">

</div>